<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Thanh toán - GreenShop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="container my-5">
    <h2>Shipping Details</h2>

    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

    <div class="row">
        <div class="col-md-7">
            <form th:action="@{/order/create}" th:object="${request}" method="post">

                <div class="mb-3">
                    <label class="form-label">Shipping Address</label>
                    <textarea class="form-control"
                              id="shippingAddress"
                              rows="3"
                              th:field="*{shippingAddress}"
                              required></textarea>
                </div>

                <h4 class="mt-4">Products to Pay</h4>
                <div class="list-group mb-4">
                    <div th:each="item : ${cart.items}" class="list-group-item d-flex align-items-center">

                        <input type="hidden" name="selectedCartItemIds" th:value="${item.id}">

                        <img th:src="${item.productImageUrl}" width="60" height="60" class="me-3 rounded object-fit-cover">

                        <div class="flex-grow-1">
                            <h6 class="mb-0" th:text="${item.productName}">Product Name</h6>
                            <small class="text-muted">
                                <span th:text="${item.quantity}"></span> x
                                ₫<span th:text="${#numbers.formatDecimal(item.unitPrice,0,2,'COMMA')}"></span>
                            </small>
                        </div>

                        <strong class="text-danger"
                                th:text="'₫' + ${#numbers.formatDecimal(item.subtotal,0,2,'COMMA')}"></strong>
                    </div>
                </div>

                <div class="border-top pt-3 text-end">
                    <div class="mb-3">
                        <span class="h4">Total Payment: </span>
                        <span class="h3 text-danger" th:text="'₫' + ${#numbers.formatDecimal(cart.totalPrice,0,2,'COMMA')}"></span>
                    </div>
                    <a href="/cart" class="btn btn-outline-secondary me-2">Back to Cart</a>
                    <button type="submit" class="btn btn-success btn-lg">Place Order</button>
                </div>
            </form>
        </div>
    </div>
</div>

</body>
</html>